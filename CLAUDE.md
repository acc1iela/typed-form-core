# CLAUDE.md

## プロジェクト概要：typed-form-core

typed-form-core は **最小構成の型安全なフォーム状態管理ライブラリ**です。
本プロジェクトは、機能の網羅性ではなく
**「TypeScript の型設計によって、どこまで不正な状態をコンパイル時に防げるか」**
を探ることを目的としています。

---

## 基本思想（Core Philosophy）

- 型を唯一の正とする
- ランタイムのロジックは最小限に抑える
- 不正な状態を「表現できない」設計を目指す
- 抽象化や魔法より、説明可能な型設計を優先する

このリポジトリは
**学習価値・設計意図の明確さを最優先**します。

---

## スコープ（厳守）

### 対象とするもの

- フラットなフォーム構造（ネストなし）
- 同期バリデーションのみ
- 型安全なフィールド登録（register）
- フィールドの型に紐づいたバリデーション
- React Hook ベースの API（`useForm`）

### 明確に対象外とするもの

- ネストしたフィールド（例：`user.address.city`）
- フィールド配列
- 非同期バリデーション
- UI コンポーネント
- 大規模フォーム向けのパフォーマンス最適化

**型の分かりやすさを損なう機能は追加しない。**

---

## 型設計の方針

### ジェネリクス命名規則

- `TValues` は **フォーム全体の値オブジェクト**を表す
- 複数の値を持つことを前提とし、単数形は使用しない
- 意味が明確な名前を優先し、不要な 1 文字ジェネリクスは避ける

---

### キーと値の強い結合

このプロジェクトで最も重要な不変条件は以下です。

> **フィールドのキーが決まれば、値の型も必ず決まる**

これを実現するために、以下のパターンを徹底します。

- `K extends keyof TValues`
- `TValues[K]`

このルールは以下すべてに適用されます。

- `register`
- `setValue`
- `validateField`
- `validators`

---

## Validators（バリデーション）

バリデーションはフィールド単位で定義し、必ず型安全である必要があります。

```ts
type Validators<TValues> = {
  [K in keyof TValues]?: (value: TValues[K], values: TValues) => string | null;
};
```
